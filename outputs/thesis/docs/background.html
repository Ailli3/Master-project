<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ANU Thesis - 2&nbsp; Background</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./methods.html" rel="next">
<link href="./intro.html" rel="prev">
<link href="./_extensions/anu-thesis/assets/ANU_Favicon_Inversed_Gold.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="_extensions/anu-thesis/assets/css/all.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./background.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Background</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">ANU Thesis</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/anuopensci/quarto-anu-thesis" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./thesis.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abstract.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abstract</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./acknowledgements.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Acknowledgements</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./background.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Background</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./methods.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Methods</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./results.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Results</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discussion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Discussion</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tools.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Tools</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar"><div class="quarto-margin-header"><div class="margin-header-item">
<p><img src="images/ANU_Primary_Vertical_GoldBlack.png" class="logo img-fluid"></p>
</div></div>
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#linear-model" id="toc-linear-model" class="nav-link active" data-scroll-target="#linear-model"><span class="header-section-number">2.1</span> Linear model</a></li>
  <li><a href="#linear-mixed-model" id="toc-linear-mixed-model" class="nav-link" data-scroll-target="#linear-mixed-model"><span class="header-section-number">3</span> Linear mixed model</a>
  <ul class="collapse">
  <li><a href="#a-criterion" id="toc-a-criterion" class="nav-link" data-scroll-target="#a-criterion"><span class="header-section-number">3.1</span> A-criterion</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/anuopensci/quarto-anu-thesis/edit/main/background.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/anuopensci/quarto-anu-thesis/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-bg" class="quarto-section-identifier"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Background</span></span></h1>
</div>


<div class="quarto-title-anu-block">


<div class="quarto-title-meta">

  
  
  </div>





</div>

</header>


<section id="linear-model" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="linear-model"><span class="header-section-number">2.1</span> Linear model</h2>
<p>Suppose we have a linear model,</p>
<p><span id="eq-lm"><span class="math display">\boldsymbol{y}=\mathbf{X}\boldsymbol{\tau} + \boldsymbol{\epsilon} \tag{2.1}</span></span> where <span class="math inline">\boldsymbol{y}</span> is <span class="math inline">n\times 1</span> vector of <span class="math inline">n</span> observations, <span class="math inline">\boldsymbol{\tau}</span> is a <span class="math inline">t\times 1</span> vector of fixed effects, <span class="math inline">\boldsymbol{\epsilon}</span> is the <span class="math inline">n\times 1</span> vector for error, and <span class="math inline">\mathbf{X}</span> is a design matrix has size <span class="math inline">n\times t</span>. We assume that <span class="math inline">\boldsymbol{\epsilon} \sim N(\boldsymbol{0}, \sigma^2\textbf{I}_{n})</span> and hence <span class="math inline">\boldsymbol{y} \sim N(\mathbf{X}\boldsymbol{\tau}, \sigma^2\mathbf{I}_n)</span>.</p>
<p>The log-likelihood of <a href="#eq-lm" class="quarto-xref">Equation&nbsp;<span>2.1</span></a> is then given as:</p>
<p><span class="math display">
\log\ell(\boldsymbol{\tau};\boldsymbol{y}) = -\frac{n}{2}\log(2\pi)-n\log(\sigma)-\frac{1}{2\sigma^2}(\boldsymbol{y}-\textbf{X}\boldsymbol{\tau})^\top(\boldsymbol{y}-\textbf{X}\boldsymbol{\tau}).
</span> The <span class="math inline">(i,j)</span>-th entry of the Fisher information matrix is defined as</p>
<p><span class="math display">
I_{ij}(\boldsymbol{\tau})=-\mathbb{E}\left(\frac{\partial^2}{\partial\tau_i\partial\tau_j}\log\ell(\boldsymbol{\tau};\boldsymbol{y})\right)
</span> where <span class="math inline">\tau_i</span> is the <span class="math inline">i</span>-th entry of <span class="math inline">\boldsymbol{\tau}</span>.</p>
<div id="lem-fim-lm" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 2.1</strong></span> The Fisher information matrix of <a href="#eq-lm" class="quarto-xref">Equation&nbsp;<span>2.1</span></a> is given as <span class="math display">
\mathbf{C} = -\mathbb{E}\left(\frac{\partial^2}{\partial\boldsymbol{\tau}\partial\boldsymbol{\tau}^\top}\log\ell(\boldsymbol{\tau};\boldsymbol{y})\right)=\frac{1}{\sigma^2}\textbf{X}^\top\textbf{X}
</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>The second derivative of the log-likelihood function <span class="math inline">\log\ell(\boldsymbol{\tau};\boldsymbol{y})</span> is the Hessian matrix. We have <span class="math display">
\frac{\partial}{\partial\boldsymbol{\tau}}\log\ell(\boldsymbol{\tau};\boldsymbol{y})=\frac{1}{\sigma^2}\textbf{X}^\top(\boldsymbol{y}-\textbf{X}\boldsymbol{\tau})
</span> and for second derivative is <span class="math display">
\frac{\partial^2}{\partial\boldsymbol{\tau}\partial\boldsymbol{\tau}^\top}\log\ell(\boldsymbol{\tau};\boldsymbol{y})==-\frac{1}{\sigma^2}\textbf{X}^\top\textbf{X}
</span> And in linear model assumption we have <span class="math inline">\boldsymbol{y} \sim N(\mathbf{X}\boldsymbol{\tau}, \sigma^2\mathbf{I}_n)</span> and the Fisher information matrix is unbiased because, in the expectation calculation process, we do not involve the randomness of <span class="math inline">\boldsymbol{y}</span>. The Fisher information matrix is actually determined by the design matrix <span class="math inline">\textbf{X}</span> and the error variance <span class="math inline">\sigma^2</span>. Hence <span class="math display">
\mathbb{E}\left(\frac{\partial^2}{\partial\boldsymbol{\tau}\partial\boldsymbol{\tau}^\top}\log\ell(\boldsymbol{\tau};\boldsymbol{y})\right)=-\frac{1}{\sigma^2}\textbf{X}^\top\textbf{X} = -\mathbf{C}
</span> So <span class="math inline">\mathbf{C} = \frac{1}{\sigma^2}\textbf{X}^\top\textbf{X}</span></p>
</div>
<div id="lem-lm-var" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 2.2</strong></span> The variance of the fixed effects for <a href="#eq-lm" class="quarto-xref">Equation&nbsp;<span>2.1</span></a> is equivalent to the inverse of the Fisher information matrix, i.e.&nbsp;<span class="math inline">var(\hat{\boldsymbol{\tau}})=\sigma^2(\textbf{X}^\top\textbf{X})^{-1} = \mathbf{C}^{-1}.</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>We know that the MLE of <span class="math inline">\boldsymbol{\tau}</span> in a linear model is <span class="math inline">\hat{\boldsymbol{\tau}}=(\textbf{X}^\top\textbf{X})^{-1}\textbf{X}^\top\boldsymbol{y}</span>. By assumption we have <span class="math inline">\boldsymbol{y} \sim N(\mathbf{X}\boldsymbol{\tau}, \sigma^2\mathbf{I}_n)</span>. So <span class="math inline">\hat{\boldsymbol{\tau}}\sim N(\boldsymbol{\tau},\sigma^2(\textbf{X}^\top\textbf{X})^{-1})</span>.So we have <span class="math inline">var(\hat{\boldsymbol{\tau}}) = \sigma^2(\textbf{X}^\top\textbf{X})^{-1}</span>, which is exactly the inverse of Fisher information matrix <span class="math inline">\mathbf{C}^{-1}</span>.</p>
</div>
</section>
<section id="linear-mixed-model" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Linear mixed model</h1>
<p>Linear mixed model extends linear model by incorporating additionally incorporating random effects into the model that effectively give greater flexibility and capability to incorporate known correlated structures into the model. We now consider a linear mixed model <span id="eq-lmm"><span class="math display">
\boldsymbol{y}=\textbf{X}\boldsymbol{\tau}+\textbf{Z}\boldsymbol{u}+\boldsymbol{\epsilon}
\tag{3.1}</span></span> here <span class="math inline">\boldsymbol{y}</span> is <span class="math inline">n\times 1</span> vector for <span class="math inline">n</span> observations, <span class="math inline">\boldsymbol{\tau}</span> is a <span class="math inline">t\times1</span> parameter vector of treatment factors, <span class="math inline">\boldsymbol{u}</span> is a <span class="math inline">q \times1</span> parameter vector of blocking effects, and <span class="math inline">\boldsymbol{\epsilon}</span> is the <span class="math inline">n\times 1</span> error vector, <span class="math inline">\textbf{X}</span> and <span class="math inline">\textbf{Z}</span> are design matrices of dimension <span class="math inline">n \times t</span> and <span class="math inline">n \times q</span> for treatment factors and blocking factors, respectively. We here assume blocking factors are random effect, with random error <span class="math inline">\boldsymbol{\epsilon}</span> we have <span class="math display">
\begin{bmatrix}
\boldsymbol{u} \\
\boldsymbol{\epsilon}
\end{bmatrix}
\sim
N\left(
\begin{bmatrix}
\boldsymbol{0} \\
\boldsymbol{0}
\end{bmatrix}
,
\begin{bmatrix}
\textbf{G} &amp; \mathbf{0} \\
\mathbf{0} &amp; \textbf{R}
\end{bmatrix}
\right),
</span> where <span class="math inline">\textbf{G}</span> is the <span class="math inline">q \times q</span> variance matrix for <span class="math inline">\boldsymbol{u}</span> and <span class="math inline">\textbf{R}</span> is <span class="math inline">n\times n</span> variance matrix for <span class="math inline">\boldsymbol{\epsilon}</span>.</p>
<section id="a-criterion" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="a-criterion"><span class="header-section-number">3.1</span> A-criterion</h2>
<p>We first start with a simple example, that is, we consider treatment factors <span class="math inline">\boldsymbol{\tau}</span> are fixed, to elucidate the influence of A-criterion.</p>
<p>From <span class="citation" data-cites="butler2013optimal">David Butler (<a href="references.html#ref-butler2013optimal" role="doc-biblioref">2013</a>)</span>, we conduct a maximum log likelihood by following objective function: <span class="math display">
\log f_Y(\boldsymbol{y}|\boldsymbol{u};\boldsymbol{\tau},\textbf{R})+\log f_u(\boldsymbol{u};\textbf{G})
</span> basing on assumption, we have <span class="math inline">\boldsymbol{y}=\textbf{X}\boldsymbol{\tau}+\textbf{Z}\boldsymbol{u}+\boldsymbol{\epsilon}\sim N(\textbf{X}\boldsymbol{\tau},\textbf{R}+\textbf{ZGZ}^\top)</span>. So for objective function, we can write out the distributions</p>
<p><span class="math display">
\boldsymbol{y}|\boldsymbol{u};\boldsymbol{\tau},\textbf{R}\sim N(\textbf{X}\boldsymbol{\tau}+\textbf{Z}\boldsymbol{u},\textbf{R}) \\
\boldsymbol{u}\sim N(\boldsymbol{0},\textbf{G})
</span></p>
<div id="lem-joint-density-lmm" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 3.1</strong></span> So log of joint density is given as</p>
<p><span class="math display">\begin{align*}
\mathscr{L}&amp;=\log f_Y(\boldsymbol{y}|\boldsymbol{u};\boldsymbol{\tau},\textbf{R})+\log f_u(\boldsymbol{u};\textbf{G})\\
&amp;=-\frac{1}{2}\left(\log|\textbf{R}|+\log|\textbf{G}|+(\boldsymbol{y}-\textbf{X}\boldsymbol{\tau}-\textbf{Z}\boldsymbol{u})^\top \mathbf{R}^{-1}(\boldsymbol{y}-\textbf{X}\boldsymbol{\tau}-\textbf{Z}\boldsymbol{u})+\boldsymbol{u}^\top\textbf{G}^{-1}\boldsymbol{u}\right)
\end{align*}</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Where is the proof?</p>
</div>
<p>We determine that <span class="math inline">\frac{\partial\mathscr{L}}{\partial\boldsymbol{\tau}}=\frac{\partial\mathscr{L}}{\partial\boldsymbol{u}}=\boldsymbol{0}</span>, and write the equation into a matrix form <span class="math display">
\begin{bmatrix}
\textbf{X}^\top\textbf{R}^{-1}\textbf{X} &amp; \textbf{X}^\top\textbf{R}^{-1}\textbf{Z}\\
\textbf{Z}^\top\textbf{R}^{-1}\textbf{X} &amp; \textbf{Z}^\top\textbf{R}^{-1}\textbf{Z}+ \textbf{G}^{-1}
\end{bmatrix}
\begin{bmatrix}
\hat{\boldsymbol{\tau}}\\
\hat{\boldsymbol{u}}
\end{bmatrix}=
\begin{bmatrix}
\textbf{X}^\top\textbf{R}^{-1}\boldsymbol{y}\\
\textbf{Z}^\top\textbf{R}^{-1}\boldsymbol{y}
\end{bmatrix}
</span></p>
<p>Let <span class="math display">
\textbf{C}=
\begin{bmatrix}
\textbf{X}^\top\textbf{R}^{-1}\textbf{X} &amp; \textbf{X}^\top\textbf{R}^{-1}\textbf{Z}\\
\textbf{Z}^\top\textbf{R}^{-1}\textbf{X} &amp; \textbf{Z}^\top\textbf{R}^{-1}\textbf{Z}+ \textbf{G}^{-1}
\end{bmatrix}
\quad
\hat{\boldsymbol{\beta}}=\begin{bmatrix}
\hat{\boldsymbol{\tau}}\\
\hat{\boldsymbol{u}}
\end{bmatrix}
\quad
\textbf{W}=\begin{bmatrix}\textbf{X} &amp;\textbf{Z}\end{bmatrix}
</span></p>
<p><span class="citation" data-cites="robinson1991blup">Robinson (<a href="references.html#ref-robinson1991blup" role="doc-biblioref">1991</a>)</span> shows that <span class="math display">
\hat{\boldsymbol{\beta}}=\begin{bmatrix}
\hat{\boldsymbol{\tau}}\\
\hat{\boldsymbol{u}}
\end{bmatrix}\sim
N(\begin{bmatrix}
\hat{\boldsymbol{\tau}}\\
\hat{\boldsymbol{u}}
\end{bmatrix}, \textbf{C}^{-1})
</span></p>
<p>We can rewrite the equation in a standard form <span class="math inline">\textbf{C}\hat\beta=\textbf{W}^\top\textbf{R}^{-1}y</span>. So <span class="math inline">\textbf{C}</span> is the Fisher information matrix for this linear mixed model. As we mentioned above, we are interesting in examine fixed effect part <span class="math inline">\boldsymbol{\tau}</span>. For the properties of variance-covariance matrix, matrix <span class="math inline">\textbf{C}</span> can be written as <span class="math display">
\textbf{C}=
\begin{bmatrix}
\textbf{C}_{11} &amp; \textbf{C}_{12}\\
\textbf{C}_{21} &amp; \textbf{C}_{22}
\end{bmatrix}
</span> <span class="math inline">\textbf{C}_{11}^{-1}</span> is a <span class="math inline">t \times t</span> matrix and variance-covariance matrix for treatment factors. We can caluclate <span class="math inline">\textbf{C}_{11}</span> by writing out standard form for <span class="math inline">\boldsymbol{\tau}</span> and cancelling <span class="math inline">\boldsymbol{u}</span>.We have <span class="math display">
\boldsymbol{X}^\top\textbf{R}^{-1}\textbf{X}\boldsymbol{\tau}+\textbf{X}^\top\textbf{R}^{-1}\textbf{Z}(\textbf{Z}^\top\textbf{R}^{-1}\textbf{Z}+\textbf{G}^{-1})\textbf{Z}^\top\textbf{R}^{-1}y=\textbf{X}^\top\textbf{R}^{-1}y\\
</span> <span class="math display">
\Rightarrow \textbf{X}^\top[\textbf{R}^{-1}-\textbf{R}^{-1}\textbf{Z}(\textbf{Z}^\top\textbf{R}^{-1}\textbf{Z}+\textbf{G}^{-1})^{-1}\textbf{Z}^\top\textbf{R}^{-1}]\textbf{X}\boldsymbol{\tau}=\textbf{X}^\top[\textbf{R}^{-1}-\textbf{R}^{-1}\textbf{Z}(\textbf{Z}^\top\textbf{R}^{-1}\textbf{Z}+\textbf{G}^{-1})^{-1}\textbf{Z}^\top\textbf{R}^{-1}]y\\
</span> <span class="math display">
\Rightarrow \textbf{X}^\top\textbf{P}\textbf{X}\boldsymbol{\tau}=\textbf{X}^\top\textbf{P}y
</span> where <span class="math inline">\textbf{P}=\textbf{R}^{-1}-\textbf{R}^{-1}\textbf{Z}(\textbf{Z}^\top\textbf{R}^{-1}\textbf{Z}+\textbf{G}^{-1})^{-1}\textbf{Z}^\top\textbf{R}^{-1}</span>, let <span class="math inline">\textbf{C}_{11}=\textbf{X}^\top\textbf{P}\textbf{X}</span> then we have the standard form for <span class="math inline">\hat{\boldsymbol{\tau}}</span>, which is <span class="math inline">\textbf{C}_{11}\boldsymbol{\tau}=\textbf{X}^\top\textbf{P}y</span>, and <span class="math inline">\textbf{C}_{11}</span> is the corresponding Fisher information matrix.</p>
<p>So we have <span class="math inline">\boldsymbol{\tau}-\hat{\boldsymbol{\tau}}\sim N(0,\textbf{C}_{11}^{-1})</span>.To examine a specific form of <span class="math inline">\boldsymbol{\tau}</span>, we do linear transform on <span class="math inline">\boldsymbol{\tau}</span>: <span class="math inline">\hat{\boldsymbol{\pi}}=\textbf{D}\hat{\boldsymbol{\tau}}</span>, where <span class="math inline">\textbf{D}</span> is some transform matrix, so we have <span class="math inline">\textbf{D}(\boldsymbol{\tau}-\hat{\boldsymbol{\tau}})=\boldsymbol{\pi}-\hat{\boldsymbol{\pi}}\sim N(0,\textbf{D}\textbf{C}_{11}^{-}\textbf{D}^\top)</span>. We denote <span class="math inline">\boldsymbol{\Lambda}=\textbf{D}\textbf{C}_{11}^{-}\textbf{D}^\top</span>.</p>
<p>A-criterion is the mean of predicted error variance of the parameter. i.e.&nbsp; <span class="math display">
\mathscr{A}=\frac{1}{n_{\pi}(n_{\pi}-1)}\sum_{i}\sum_{j&lt;i} predicted\quad error\quad variance\quad of\quad(\hat\pi_i-\hat\pi_j)
</span> where <span class="math inline">n_{\pi}</span> is the row number of vector <span class="math inline">\pi</span>.For error variance part, we have <span class="math display">
\sum_{i}\sum_{j&lt;i} predicted\quad error\quad variance\quad of\quad(\hat\pi_i-\hat\pi_j)=\sum_{i}\sum_{j&lt;i}var(\hat\pi_i-\hat\pi_j)=\sum_{i}\sum_{j&lt;i}[var(\hat\pi_i)+var(\hat\pi_j)-2cov(\hat\pi_i,\hat\pi_j)]
</span> from virance-covirance matrix <span class="math inline">\boldsymbol{\Lambda}</span>, we can rewrite the sum part as <span class="math inline">n_{\pi}tr(\boldsymbol{\Lambda})-\mathbb{1}_{n_{\pi}}^\top\boldsymbol{\Lambda}\mathbb{1}_{n_{\pi}}</span>.So we have <span class="math display">
\mathscr{A}=\frac{1}{n_{\pi}(n_{\pi}-1)}[n_{\pi}tr(\boldsymbol{\Lambda})-\mathbb{1}_{n_{\pi}}^\top\boldsymbol{\Lambda}\mathbb{1}_{n_{\pi}}]
</span> same result from <span class="citation" data-cites="butler2013model">DG Butler, Smith, and Cullis (<a href="references.html#ref-butler2013model" role="doc-biblioref">2013</a>)</span></p>
<p>Derivation above indicate that <span class="math inline">\mathscr{A}\propto tr(\boldsymbol{\Lambda})</span>, A-criterion as the mean of predicted error variance of the parameter, we prefer it as small as possible to obtain a accurate result from experiment, which means the trace of virance-covirance matrix <span class="math inline">\boldsymbol{\Lambda}</span> should be as small as possible. And this is our goal on optimal experimental design.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-butler2013optimal" class="csl-entry" role="listitem">
Butler, David. 2013. <span>“On the Optimal Design of Experiments Under the Linear Mixed Model.”</span>
</div>
<div id="ref-butler2013model" class="csl-entry" role="listitem">
Butler, DG, AB Smith, and BR Cullis. 2013. <span>“On Model Based Design of Comparative Experiments.”</span> preparation.
</div>
<div id="ref-robinson1991blup" class="csl-entry" role="listitem">
Robinson, George K. 1991. <span>“That BLUP Is a Good Thing: The Estimation of Random Effects.”</span> <em>Statistical Science</em>, 15–32.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./intro.html" class="pagination-link" aria-label="Introduction">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./methods.html" class="pagination-link" aria-label="Methods">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Methods</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright © 2024, Your Name</p>
<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/anuopensci/quarto-anu-thesis/edit/main/background.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/anuopensci/quarto-anu-thesis/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>